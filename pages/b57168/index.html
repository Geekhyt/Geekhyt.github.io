<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript 设计模式(二) | 童欧巴博客</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="web前端技术博客,简洁至上,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="code-1xXsjR4O7D">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.5d660632.css" as="style"><link rel="preload" href="/assets/js/app.e6110941.js" as="script"><link rel="preload" href="/assets/js/2.d5df4bac.js" as="script"><link rel="preload" href="/assets/js/3.91f688ac.js" as="script"><link rel="preload" href="/assets/js/21.fd13e0c4.js" as="script"><link rel="prefetch" href="/assets/js/10.3199ebec.js"><link rel="prefetch" href="/assets/js/11.23fcadef.js"><link rel="prefetch" href="/assets/js/12.c0606614.js"><link rel="prefetch" href="/assets/js/13.f31dd943.js"><link rel="prefetch" href="/assets/js/14.b62224fa.js"><link rel="prefetch" href="/assets/js/15.12d722d0.js"><link rel="prefetch" href="/assets/js/16.c18c577a.js"><link rel="prefetch" href="/assets/js/17.33db1aff.js"><link rel="prefetch" href="/assets/js/18.2169539d.js"><link rel="prefetch" href="/assets/js/19.80147783.js"><link rel="prefetch" href="/assets/js/20.750d5116.js"><link rel="prefetch" href="/assets/js/22.c2229ed4.js"><link rel="prefetch" href="/assets/js/23.2dffd82d.js"><link rel="prefetch" href="/assets/js/24.ed95c331.js"><link rel="prefetch" href="/assets/js/25.273f6808.js"><link rel="prefetch" href="/assets/js/26.f81c2466.js"><link rel="prefetch" href="/assets/js/27.ed1fa402.js"><link rel="prefetch" href="/assets/js/28.86bddcec.js"><link rel="prefetch" href="/assets/js/29.acb6ba1d.js"><link rel="prefetch" href="/assets/js/30.085db3bb.js"><link rel="prefetch" href="/assets/js/31.10a4a0ad.js"><link rel="prefetch" href="/assets/js/32.dab0f919.js"><link rel="prefetch" href="/assets/js/33.ff4e525c.js"><link rel="prefetch" href="/assets/js/34.4972fdf0.js"><link rel="prefetch" href="/assets/js/35.8eef4f2e.js"><link rel="prefetch" href="/assets/js/36.12e3a40e.js"><link rel="prefetch" href="/assets/js/37.1d8cac74.js"><link rel="prefetch" href="/assets/js/38.1b9d84f3.js"><link rel="prefetch" href="/assets/js/39.8da043e8.js"><link rel="prefetch" href="/assets/js/4.f0bed083.js"><link rel="prefetch" href="/assets/js/40.cad56f3f.js"><link rel="prefetch" href="/assets/js/41.078ff48e.js"><link rel="prefetch" href="/assets/js/42.ccab846c.js"><link rel="prefetch" href="/assets/js/43.505c53c7.js"><link rel="prefetch" href="/assets/js/44.cd659556.js"><link rel="prefetch" href="/assets/js/45.14dd0e87.js"><link rel="prefetch" href="/assets/js/46.1839d303.js"><link rel="prefetch" href="/assets/js/47.b210acd4.js"><link rel="prefetch" href="/assets/js/48.5748de13.js"><link rel="prefetch" href="/assets/js/49.0855ea96.js"><link rel="prefetch" href="/assets/js/5.3325315f.js"><link rel="prefetch" href="/assets/js/50.ec32b7d5.js"><link rel="prefetch" href="/assets/js/51.2bbf040f.js"><link rel="prefetch" href="/assets/js/52.3305d4e2.js"><link rel="prefetch" href="/assets/js/53.5ddbb2ed.js"><link rel="prefetch" href="/assets/js/54.66fb0ed1.js"><link rel="prefetch" href="/assets/js/55.502aea49.js"><link rel="prefetch" href="/assets/js/56.b8d4f0b6.js"><link rel="prefetch" href="/assets/js/57.631c9b6f.js"><link rel="prefetch" href="/assets/js/58.de68c1bb.js"><link rel="prefetch" href="/assets/js/59.a8e3322d.js"><link rel="prefetch" href="/assets/js/6.e60bc4f1.js"><link rel="prefetch" href="/assets/js/60.405df580.js"><link rel="prefetch" href="/assets/js/61.b8c9ede6.js"><link rel="prefetch" href="/assets/js/62.ad006f4a.js"><link rel="prefetch" href="/assets/js/63.3a8cad4b.js"><link rel="prefetch" href="/assets/js/64.7f3316c4.js"><link rel="prefetch" href="/assets/js/65.baee1c39.js"><link rel="prefetch" href="/assets/js/66.726c4408.js"><link rel="prefetch" href="/assets/js/67.03b35a22.js"><link rel="prefetch" href="/assets/js/7.a139d7a8.js"><link rel="prefetch" href="/assets/js/8.bb4f29c6.js"><link rel="prefetch" href="/assets/js/9.7d18e657.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5d660632.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/avatar.jpeg" alt="童欧巴博客" class="logo"> <span class="site-name can-hide">童欧巴博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友情链接</a></div> <a href="https://github.com/Geekhyt" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="http://hungryturbo.gitee.io/webcanteen/images/avatar.jpeg"> <div class="blogger-info"><h3>童欧巴</h3> <span>公众号【前端食堂】主理人</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友情链接</a></div> <a href="https://github.com/Geekhyt" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/pages/6ba756/" class="sidebar-link">JavaScript This 详解</a></li><li><a href="/pages/7a7e60/" class="sidebar-link">JavaScript 事件循环</a></li><li><a href="/pages/f5199e/" class="sidebar-link">JavaScript 原型链</a></li><li><a href="/pages/ef1cc5/" class="sidebar-link">JavaScript 闭包</a></li><li><a href="/pages/16a494/" class="sidebar-link">JavaScript 设计模式一</a></li><li><a href="/pages/b57168/" aria-current="page" class="active sidebar-link">JavaScript 设计模式二</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/b57168/#外观模式-facade" class="sidebar-link">外观模式 Facade</a></li><li class="sidebar-sub-header"><a href="/pages/b57168/#适配器模式-adapter" class="sidebar-link">适配器模式 Adapter</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/b57168/#jquery中的适配器" class="sidebar-link">jQuery中的适配器</a></li><li class="sidebar-sub-header"><a href="/pages/b57168/#参数适配器" class="sidebar-link">参数适配器</a></li><li class="sidebar-sub-header"><a href="/pages/b57168/#数据适配" class="sidebar-link">数据适配</a></li><li class="sidebar-sub-header"><a href="/pages/b57168/#服务端数据适配" class="sidebar-link">服务端数据适配</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/b57168/#代理模式-proxy" class="sidebar-link">代理模式 Proxy</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/b57168/#虚拟代理" class="sidebar-link">虚拟代理</a></li><li class="sidebar-sub-header"><a href="/pages/b57168/#缓存代理" class="sidebar-link">缓存代理</a></li><li class="sidebar-sub-header"><a href="/pages/b57168/#es6中的proxy" class="sidebar-link">ES6中的Proxy</a></li><li class="sidebar-sub-header"><a href="/pages/b57168/#vue3-0中的proxy" class="sidebar-link">Vue3.0中的Proxy</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/b57168/#装饰者模式-decorator" class="sidebar-link">装饰者模式 Decorator</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/b57168/#typescript的装饰器" class="sidebar-link">TypeScript的装饰器@</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/b57168/#桥接模式-bridge" class="sidebar-link">桥接模式 Bridge</a></li><li class="sidebar-sub-header"><a href="/pages/b57168/#组合模式-composite" class="sidebar-link">组合模式 Composite</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/b57168/#jquery中addclass实现" class="sidebar-link">jQuery中addClass实现</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/b57168/#享元模式-flyweight" class="sidebar-link">享元模式 Flyweight</a></li><li class="sidebar-sub-header"><a href="/pages/b57168/#参考：" class="sidebar-link">参考：</a></li></ul></li><li><a href="/pages/4b77ce/" class="sidebar-link">JavaScript 设计模式三</a></li><li><a href="/pages/c48ab5/" class="sidebar-link">前端模块化发展史</a></li><li><a href="/pages/f3e0a1/" class="sidebar-link">从今天起构建你的JavaScript世界</a></li><li><a href="/pages/10561c/" class="sidebar-link">种草ECMAScript2021新特性</a></li><li><a href="/pages/d03b5d/" class="sidebar-link">手写Promise全家桶</a></li><li><a href="/pages/0618df/" class="sidebar-link">揭秘TC39之ES2020 和 ES2021</a></li><li><a href="/pages/afe888/" class="sidebar-link">2021年前端工程师书单推荐</a></li><li><a href="/pages/c0e0d4/" class="sidebar-link">假如易立竞问你如何判断 JavaScript 中的数据类型？</a></li></ul> </aside> <div><main class="page"> <div class="theme-vdoing-wrapper bg-style-1"><div class="articleInfo-wrap" data-v-f5f35434><div class="articleInfo" data-v-f5f35434><ul class="breadcrumbs" data-v-f5f35434><li data-v-f5f35434><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-f5f35434></a></li> <li data-v-f5f35434><a href="/categories/?category=JavaScript" title="分类" data-v-f5f35434>JavaScript</a></li> <!----></ul> <div class="info" data-v-f5f35434><div title="作者" class="author iconfont icon-touxiang" data-v-f5f35434><a href="https://github.com/Geekhyt" target="_blank" title="作者" class="beLink" data-v-f5f35434>童欧巴</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-f5f35434><a href="javascript:;" data-v-f5f35434>2019-10-09</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><!---->
          JavaScript 设计模式(二)
        </h1> <div class="theme-vdoing-content content__default"><p>有人问我坚持写博客的原因是什么？</p> <p>借用著名小说家<code>斯蒂芬·金</code>的一句话：“开始写吧！年轻人。”</p> <p>当你把<code>消费级兴趣</code>升级为<code>生产型兴趣</code>时，你才会渐渐发现以前没有窥见的门道和妙处。</p> <p>你品，你细品！</p> <p>咳咳，天凉了请喝鸡汤～</p> <p>可能本系列文章中所讲的设计模式你在工作中经常应用它们，但是并不知道它们的名字。</p> <p>一旦我们将这些设计模式整理学习并融会贯通后，便可以大大增强我们的编程功底，在遇到实际业务需求时，给我们提供更好的解决问题的思路。</p> <p>毕竟我们的口号是：不加班！</p> <p>书接上文，本文给大家介绍的是<code>结构型设计模式</code>，包括<code>外观模式</code>、<code>适配器模式</code>、<code>代理模式</code>、<code>装饰者模式</code>、<code>桥接模式</code>、<code>组合模式</code>以及<code>享元模式</code>。</p> <h2 id="外观模式-facade"><a href="#外观模式-facade" class="header-anchor">#</a> 外观模式 Facade</h2> <p><code>概念：可以对复杂的子系统接口提供一个更高级的统一接口，对底层结构兼容性做统一封装来简化用户使用。</code></p> <p>这种模式比较简单也比较容易理解，在日常的开发中你一定遇到过以下的场景。</p> <p>那些年我们对ie浏览器做过的兼容。。</p> <p>IE：我太难了！</p> <p>这些常见的兼容方案属于外观模式。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">getEvent</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> event <span class="token operator">||</span> window<span class="token punctuation">.</span>event<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">getTarget</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> event <span class="token operator">=</span> <span class="token function">getEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> event<span class="token punctuation">.</span>target <span class="token operator">||</span> event<span class="token punctuation">.</span>srcElement<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">preventDefault</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> event <span class="token operator">=</span> <span class="token function">getEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>preventDefault<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">.</span>returnValue <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">stopBubble</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> event <span class="token operator">=</span> <span class="token function">getEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>stopPropagation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">.</span>cancelBubble <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>在团队开发中，为了避免添加点击事件时出现的重名覆盖问题，我们会使用DOM2级事件处理程序绑定事件，并添加对浏览器的兼容。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">addEvent</span> <span class="token punctuation">(</span><span class="token parameter">dom<span class="token punctuation">,</span> type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>dom<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dom<span class="token punctuation">.</span><span class="token function">addEventListener</span> <span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>dom<span class="token punctuation">.</span>attachEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 兼容IE(低于9)</span>
    dom<span class="token punctuation">.</span><span class="token function">attachEvent</span><span class="token punctuation">(</span><span class="token string">'on'</span> <span class="token operator">+</span> type<span class="token punctuation">,</span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    dom<span class="token punctuation">[</span><span class="token string">'on'</span> <span class="token operator">+</span> type<span class="token punctuation">]</span> <span class="token operator">=</span> fn<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>你当然也可以通过外观模式，来封装多个功能来简化底层操作方法。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token constant">T</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">g</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">css</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">attr</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">html</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> html</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> html<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">on</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'on'</span> <span class="token operator">+</span> type<span class="token punctuation">]</span> <span class="token operator">=</span> fn<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token constant">T</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">,</span> <span class="token string">'background'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">T</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">,</span> <span class="token string">'className'</span><span class="token punctuation">,</span> <span class="token string">'box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">T</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">,</span> <span class="token string">'这是新添加的内容'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">T</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token constant">T</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">,</span> <span class="token string">'width'</span><span class="token punctuation">,</span> <span class="token string">'500px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>外观模式对接口进行了包装，我们使用时无须知道接口实现的具体细节，按照规则使用即可。</p> <h2 id="适配器模式-adapter"><a href="#适配器模式-adapter" class="header-anchor">#</a> 适配器模式 Adapter</h2> <p><code>概念:将一个类(对象)的接口(方法或者属性)转化成另外一个接口，以满足用户需求，使类(对象)之间接口的不兼容问题通过适配器得以解决。</code></p> <p>适配器在我们的日常生活中很常见，比如出国旅行时，有的国家只有三项的插座，这时候我们需要三项转两项插头电源适配器。再比如iPhone7以后耳机接口变成了lightning接口，为了适配圆孔耳机苹果为我们提供了适配器。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 为两个代码库所写的代码兼容运行而书写的额外代码是适配器的一种。</span>
window<span class="token punctuation">.</span><span class="token constant">A</span> <span class="token operator">=</span> <span class="token constant">A</span> <span class="token operator">=</span> jQuery<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="jquery中的适配器"><a href="#jquery中的适配器" class="header-anchor">#</a> jQuery中的适配器</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
jQuery核心cssHook
<span class="token comment">// (为了控制文数，此处不贴代码，阅读完后大家可自行去官网查看)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><a href="https://jquery.com/download/" target="_blank" rel="noopener noreferrer">jQuery源码地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="参数适配器"><a href="#参数适配器" class="header-anchor">#</a> 参数适配器</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">doSomeThing</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> title<span class="token punctuation">,</span> age<span class="token punctuation">,</span> color<span class="token punctuation">,</span> size<span class="token punctuation">,</span> prize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 我们记住这些参数的顺序是很困难的，所以我们经常是以一个参数对象方式来传入</span>
<span class="token comment">/**
* obj.name : name
* obj.title : title
* obj.age : age
* obj.color : color
* obj.size : size
* obj.prize : prize
**/</span>
<span class="token comment">// 当调用它的时候我们要考虑到传递的参数是否完整的问题，如果有一些必须参数没有传入</span>
<span class="token comment">// 一些参数是有默认值的等等。这时我们可以用适配器来适配传入的参数对象</span>
<span class="token keyword">function</span> <span class="token function">doSomeThing</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _adapter <span class="token operator">=</span> <span class="token punctuation">{</span>
    name <span class="token operator">:</span> <span class="token string">'前端食堂'</span><span class="token punctuation">,</span>
    title <span class="token operator">:</span> <span class="token string">'设计模式'</span><span class="token punctuation">,</span>
    age <span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
    color <span class="token operator">:</span> <span class="token string">'blue'</span><span class="token punctuation">,</span>
    size <span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
    prize <span class="token operator">:</span> <span class="token number">99</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> _adapter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _adapter<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">||</span> _adapter<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 或者extend(_adapter, obj) 注: 此时可能会多添加属性</span>
  <span class="token comment">// do things</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>很多插件对于参数配置都是这么做的。</p> <h3 id="数据适配"><a href="#数据适配" class="header-anchor">#</a> 数据适配</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'前端食堂'</span><span class="token punctuation">,</span> <span class="token string">'restaurant'</span><span class="token punctuation">,</span> <span class="token string">'记得按时吃饭'</span><span class="token punctuation">,</span> <span class="token string">'9月30日'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 我们发现数组中每个成员代表的意义不同，所以这种数据结构 语义不好，我们将其适配成对象。</span>

<span class="token keyword">function</span> <span class="token function">arrToObjAdapter</span> <span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    name <span class="token operator">:</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    type <span class="token operator">:</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    title <span class="token operator">:</span> arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    data <span class="token operator">:</span> arr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> adapterData <span class="token operator">=</span> <span class="token function">arrToObjAdapter</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>adapterData<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token comment">// {name:&quot;前端食堂&quot;, type:&quot;restaurant&quot;, title:&quot;记得按时吃饭&quot;,data:&quot;9月30日&quot;}  </span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="服务端数据适配"><a href="#服务端数据适配" class="header-anchor">#</a> 服务端数据适配</h3> <p>现在主流的方案是用<code>node.js</code>写中间层-<code>BFF层(Backend for Frontend)</code>，获取到后台返回的数据后进行处理，
处理为前端想要的数据，这样也不失为一种适配器模式。</p> <p><strong>与外观模式的区别：</strong></p> <p>相比于外观模式，适配器模式要了解适配对象的内部结构。</p> <h2 id="代理模式-proxy"><a href="#代理模式-proxy" class="header-anchor">#</a> 代理模式 Proxy</h2> <p><code>概念：由于一个对象不能直接引用另一个对象，所以需要通过代理对象在这两个对象之间起到中介的作用。</code></p> <p>现实生活中比如我们租房子时回去自如，自如是房屋中介机构，也就是我们的代理。</p> <p>在<code>javaScript</code>中使用最多的就是虚拟代理和缓存代理。</p> <h3 id="虚拟代理"><a href="#虚拟代理" class="header-anchor">#</a> 虚拟代理</h3> <p>图片loading预加载</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 创建本体对象，生成img标签，对外提供setSrc接口</span>
<span class="token keyword">var</span> myImage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> imgNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>imgNode<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">setSrc</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      imgNode<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment">// 引入代理对象，图片加载之前会有个loading.gif</span>
 <span class="token keyword">var</span> proxyImage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     myImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">return</span> <span class="token punctuation">{</span>
     <span class="token function-variable function">setSrc</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       myImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span><span class="token string">'loading.gif'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       img<span class="token punctuation">.</span>src<span class="token operator">=</span> src<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">// 通过代理得到图片</span>
 proxyImg<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span><span class="token string">'http://...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="缓存代理"><a href="#缓存代理" class="header-anchor">#</a> 缓存代理</h3> <p>可以为一些开销很大的运算结果提供暂时的储存，若下次传递的参数一致则直接返回之前的结果，大大提高效率和节省开销。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">computedFn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'开始'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> l <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a <span class="token operator">=</span> a <span class="token operator">*</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> proxyComputed <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>args <span class="token keyword">in</span> cache<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">computedFn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">proxyComputed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 24</span>
<span class="token function">proxyComputed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 24</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>如上所示，代理模式可以解决系统之间的耦合度以及系统资源开销大的问题，</p> <h3 id="es6中的proxy"><a href="#es6中的proxy" class="header-anchor">#</a> ES6中的Proxy</h3> <p>ES6所提供的Proxy构造函数能够让我们轻松的使用代理模式。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// target所要代理的对象</span>
<span class="token comment">// handler设置对所代理的对象的行为</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><a href="http://es6.ruanyifeng.com/#docs/proxy" target="_blank" rel="noopener noreferrer">ES6中的Proxy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="vue3-0中的proxy"><a href="#vue3-0中的proxy" class="header-anchor">#</a> Vue3.0中的Proxy</h3> <p>vue3.0中的双向数据绑定原理用了es6中的Proxy，并优雅的解决了Proxy细节上的一些问题，从而完美的实现双向绑定，大家可以去阅读源码，或是社区中的<a href="https://juejin.im/post/5d99be7c6fb9a04e1e7baa34" target="_blank" rel="noopener noreferrer">这篇文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，这里不作展开。</p> <h2 id="装饰者模式-decorator"><a href="#装饰者模式-decorator" class="header-anchor">#</a> 装饰者模式 Decorator</h2> <p><code>概念：在不改变原对象的基础上，通过对其进行包装拓展(添加属性或者方法)使原有对象可以满足用户的更复杂需求。</code></p> <h3 id="typescript的装饰器"><a href="#typescript的装饰器" class="header-anchor">#</a> TypeScript的装饰器@</h3> <p>装饰器是一项实验性特性，在未来的版本中可能会发生改变。</p> <p>具体使用方法请移步<a href="https://www.tslang.cn/docs/handbook/decorators.html" target="_blank" rel="noopener noreferrer">官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>假设我们在开发中有这样一个需求，在不影响原有事件的前提下，新增事件实现业务，就可以通过装饰者来实现。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 装饰者</span>
<span class="token keyword">var</span> <span class="token function-variable function">decorator</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">input<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取事件源</span>
  <span class="token keyword">var</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 若事件源已经绑定事件</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> input<span class="token punctuation">.</span>onclick <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 缓存事件源原有回调函数</span>
    <span class="token keyword">var</span> oldClickFn <span class="token operator">=</span> input<span class="token punctuation">.</span>onclick<span class="token punctuation">;</span>
    <span class="token comment">// 为事件源定义新的事件</span>
    input<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 事件源原有回调函数</span>
      <span class="token function">oldClickFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 执行事件源新增回调函数</span>
      <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 事件源未绑定事件，直接为事件源添加新增回调函数</span>
    input<span class="token punctuation">.</span>onclick <span class="token operator">=</span> fn<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>与适配者模式的区别：</strong></p> <p>在适配者模式中要了解原有方法实现的具体细节，而在装饰者模式只有当我们调用方法时才会知道其内部细节，这是对原有功能完整性的一种保护。</p> <h2 id="桥接模式-bridge"><a href="#桥接模式-bridge" class="header-anchor">#</a> 桥接模式 Bridge</h2> <p><code>概念：在系统沿着多个维度变化的同时，又不增加其复杂度并已达到解耦。</code></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> spans <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 为用户名绑定特效</span>
spans<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onmouseover</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token string">'#ddd'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
spans<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onmouseout</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'#333'</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token string">'#f5f5f5'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 为等级绑定特效</span>
spans<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onmouseover</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getELementsByTagName</span><span class="token punctuation">(</span><span class="token string">'strong'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'strong'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token string">'#ddd'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
spans<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onmouseout</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getELementsByTagName</span><span class="token punctuation">(</span><span class="token string">'strong'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'#333'</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'strong'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token string">'#f5f5f5'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 提取共同点，解除与事件中的this的耦合</span>
<span class="token keyword">function</span> <span class="token function">changeColor</span> <span class="token punctuation">(</span><span class="token parameter">dom<span class="token punctuation">,</span> color<span class="token punctuation">,</span> bg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  dom<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> color<span class="token punctuation">;</span>
  dom<span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> bg<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用匿名函数，事件与业务逻辑之间的桥梁</span>
<span class="token keyword">var</span> spans <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
spans<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onmouseover</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">changeColor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'#ddd'</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// changeColor方法中的dom实质上是事件回调函数中的this，解除它们之间的耦合</span>
<span class="token comment">// 我们使用了一个桥接方法-匿名回调函数。通过这个匿名回调函数</span>
<span class="token comment">// 我们将获取到的this传递到changeColor函数中，即可实现需求</span>
spans<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onmouseout</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">changeColor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'#333'</span><span class="token punctuation">,</span> <span class="token string">'#f5f5f5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 同样的道理应用在用户等级上</span>
spans<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onmouseover</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">changeColor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'strong'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'#ddd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
spans<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onmouseout</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">changeColor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'strong'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'#333'</span><span class="token punctuation">,</span> <span class="token string">'#f5f5f5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 如果需求再有变化，只需要修改changeColor的内容就可以了</span>
<span class="token comment">// 而不必去到每个事件回调函数中去修改，以新增一个桥接函数为代价</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>将实现层(如元素绑定的事件)与抽象层(如修饰页面UI逻辑)解耦分离，使两部分可以独立变化。</p> <p>注意，有些时候，对于桥梁的添加，会造成开发成本增加，性能上也会受影响。</p> <h2 id="组合模式-composite"><a href="#组合模式-composite" class="header-anchor">#</a> 组合模式 Composite</h2> <p><code>概念：又称部分-整体模式，将对象组合成树形结构以表示“部分整体”的层次结构，组合模式使得用户对单个对象和组合对象的使用具有一致性。</code></p> <p><strong>中餐厅：套餐服务</strong> 黄**：我觉得不行。</p> <p><strong>webpack构建项目的目录结构</strong></p> <p><strong>公司部门组织架构</strong></p> <p>组合模式能够给我们提供一个清晰的组成结构。组合对象类通过继承同一个父类使其具有统一的方法，这样也方便了我们统一管理和使用。</p> <h3 id="jquery中addclass实现"><a href="#jquery中addclass实现" class="header-anchor">#</a> jQuery中addClass实现</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// jQuery 3.4.1</span>
<span class="token function-variable function">addClass</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">value</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> classes<span class="token punctuation">,</span> elem<span class="token punctuation">,</span> cur<span class="token punctuation">,</span> curValue<span class="token punctuation">,</span> clazz<span class="token punctuation">,</span> j<span class="token punctuation">,</span> finalValue<span class="token punctuation">,</span>
	i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">isFunction</span><span class="token punctuation">(</span> value <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">j</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">jQuery</span><span class="token punctuation">(</span> <span class="token keyword">this</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span> <span class="token function">value</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token function">getClass</span><span class="token punctuation">(</span> <span class="token keyword">this</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	classes <span class="token operator">=</span> <span class="token function">classesToArray</span><span class="token punctuation">(</span> value <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span> classes<span class="token punctuation">.</span>length <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span> elem <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span> i<span class="token operator">++</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
			curValue <span class="token operator">=</span> <span class="token function">getClass</span><span class="token punctuation">(</span> elem <span class="token punctuation">)</span><span class="token punctuation">;</span>
			cur <span class="token operator">=</span> elem<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> <span class="token function">stripAndCollapse</span><span class="token punctuation">(</span> curValue <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span> cur <span class="token punctuation">)</span> <span class="token punctuation">{</span>
				j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
				<span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span> clazz <span class="token operator">=</span> classes<span class="token punctuation">[</span> j<span class="token operator">++</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span> cur<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> clazz <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
							cur <span class="token operator">+=</span> clazz <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>

				<span class="token comment">// Only assign if different to avoid unneeded rendering.</span>
				finalValue <span class="token operator">=</span> <span class="token function">stripAndCollapse</span><span class="token punctuation">(</span> cur <span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span> curValue <span class="token operator">!==</span> finalValue <span class="token punctuation">)</span> <span class="token punctuation">{</span>
					elem<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span> <span class="token string">&quot;class&quot;</span><span class="token punctuation">,</span> finalValue <span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>我们无须知道addClass的内部结构和实现细节，就可以使用addClass来对标签添加类。</p> <h2 id="享元模式-flyweight"><a href="#享元模式-flyweight" class="header-anchor">#</a> 享元模式 Flyweight</h2> <p><code>概念：运用共享技术有效地支持大量的细粒度的对象，避免对象间拥有相同内容造成多余的开销。</code></p> <p><code>核心思想</code>：共享细粒度对象</p> <p><code>最终目标</code>：尽量减少共享对象的数量</p> <p>现实生活中，LOL、农药段位之分是享元模式的思想，咖啡厅的咖啡种类也是享元模式的思想。</p> <p>在我们熟知的原型链继承中，当子类实例很多的时候，子类可以通过原型来复用父类的方法和属性来优化内存，这也是享元模式的思想。</p> <p>除此之外，Node.js中的线程池、数据库的连接池、HTTP连接池以及字符常量池都是享元模式或其升级版。</p> <h2 id="参考："><a href="#参考：" class="header-anchor">#</a> 参考：</h2> <p>《JavaScript设计模式》张容铭</p></div></div> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=JavaScript" title="标签">#JavaScript</a><a href="/tags/?tag=%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F" title="标签">#设计模式</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2020/10/01, 19:10:00</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/16a494/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">JavaScript 设计模式一</div></a> <a href="/pages/4b77ce/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">JavaScript 设计模式三</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/16a494/" class="prev">JavaScript 设计模式一</a></span> <span class="next"><a href="/pages/4b77ce/">JavaScript 设计模式三</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/fa7f62/"><div>教女朋友学前端之深入理解JS引擎</div></a> <span>08-16</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/aa01e0/"><div>如何打造高效好用的终端？拿来吧你！</div></a> <span>07-14</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/c0e0d4/"><div>假如易立竞问你如何判断 JavaScript 中的数据类型？</div></a> <span>06-08</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div> </main></div> <div class="footer"><div class="icons"><a href="mailto:hungryturbo@gmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Geekhyt" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://juejin.im/user/3491704662669469" title="掘金" target="_blank" class="iconfont icon-juejin"></a><a href="https://www.zhihu.com/people/huo-yi-tong-98" title="知乎" target="_blank" class="iconfont icon-zhihu"></a><a href="https://weibo.com/u/2771284557" title="微博" target="_blank" class="iconfont icon-weibo"></a><a href="https://space.bilibili.com/161753278" title="哔哩哔哩" target="_blank" class="iconfont icon-bilibili"></a></div> 
        © 2019-2021
        <span>童欧巴 | hungryturbo</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e6110941.js" defer></script><script src="/assets/js/2.d5df4bac.js" defer></script><script src="/assets/js/3.91f688ac.js" defer></script><script src="/assets/js/21.fd13e0c4.js" defer></script>
  </body>
</html>